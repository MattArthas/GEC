create table GEC_LOCATE_PREBORROW_ARCHIVE
(
  LOCATE_PREBORROW_ID   NUMBER(38) not null,
  LOCATE_ID             VARCHAR2(30),
  IM_AVAILABILITY_ID    NUMBER(38),
  ASSET_ID              NUMBER(38),
  BUSINESS_DATE         NUMBER(8),
  CLIENT_CD             VARCHAR2(32),
  IM_USER_ID            VARCHAR2(64),
  INVESTMENT_MANAGER_CD VARCHAR2(32),
  FUND_CD               VARCHAR2(4),
  FUND_SOURCE           VARCHAR2(1),
  IM_DEFAULT_FUND_CD    VARCHAR2(4),
  IM_DEFAULT_CLIENT_CD  VARCHAR2(32),
  STRATEGY_ID           NUMBER(38),
  TRANSACTION_CD        VARCHAR2(10),
  ASSET_CODE            VARCHAR2(20),
  ASSET_CODE_TYPE       VARCHAR2(3),
  CUSIP                 VARCHAR2(9),
  ISIN                  VARCHAR2(12),
  SEDOL                 VARCHAR2(7),
  QUIK                  VARCHAR2(5),
  TICKER                VARCHAR2(50),
  ASSET_TYPE_ID			VARCHAR2(1),  
  DESCRIPTION           VARCHAR2(50),
  FILE_VERSION          NUMBER(2),
  SHARE_QTY             NUMBER(38) default 0,
  RESERVED_SB_QTY       NUMBER(38) default 0,
  SB_QTY_RAL            NUMBER(38) default 0,
  RESERVED_NSB_QTY      NUMBER(38) default 0,
  SB_RATE               NUMBER(9,6) default 0,
  NSB_LOAN_NO           VARCHAR2(250),
  NSB_RATE              NUMBER(9,6) default 0,
  INDICATIVE_RATE       VARCHAR2(10),
  SOURCE_CD             VARCHAR2(64),
  REMAINING_SFP         NUMBER(38) default 0,
  POSITION_FLAG         VARCHAR2(2),
  SB_BROKER             VARCHAR2(250),
  RESTRICTION_CD        VARCHAR2(1),
  RESERVED_NFS_QTY      NUMBER(38) default 0,
  NFS_BORROW_ID         VARCHAR2(10),
  NFS_RATE              NUMBER(9,6) default 0,
  RESERVED_EXT2_QTY     NUMBER(38) default 0,
  EXT2_BORROW_ID        VARCHAR2(10),
  EXT2_RATE             NUMBER(9,6) default 0,
  STATUS                VARCHAR2(1),
  INITIAL_FLAG          VARCHAR2(1) default 'N' not null,
  UPDATED_BY            VARCHAR2(64),
  UPDATED_AT            DATE,
  CREATED_BY            VARCHAR2(64),
  CREATED_AT            DATE,
  COMMENT_TXT           VARCHAR2(4000),
  INTERNAL_COMMENT_TXT  VARCHAR2(4000),
  TRADER_APPROVED_QTY	NUMBER(38),
  REQUEST_ID			NUMBER(38),
  IM_REQUEST_ID			VARCHAR2(64),
  IM_LOCATE_ID			VARCHAR2(64), 
  TRADE_COUNTRY_CD   	VARCHAR2(3),
  TRADE_COUNTRY_ALIAS_CD   	VARCHAR2(3), 
  SCHEDULED_AT			DATE,
  AT_POINT_AVAIL_QTY	NUMBER(38),
  AGENCY_BORROW_RATE	VARCHAR2(250),
  RECLAIM_RATE	        VARCHAR2(250),
  ROW_NUMBER            NUMBER(6),
  LIQUIDITY_FLAG        VARCHAR2(3),
  LAST_UPDATED_BY       VARCHAR2(64),
  LAST_UPDATED_AT       DATE
)TABLESPACE GEC
;
alter table GEC_LOCATE_PREBORROW_ARCHIVE
  add ( constraint GEC_LOCATE_PREBORROW_ARCHV_PK primary key (LOCATE_PREBORROW_ID)  USING INDEX TABLESPACE  GEC);
alter table GEC_LOCATE_PREBORROW_ARCHIVE
  add constraint GEC_LOCATE_PREBORROW_ARCHV_FK1 foreign key (ASSET_ID)
  references GEC_ASSET (ASSET_ID);
alter table GEC_LOCATE_PREBORROW_ARCHIVE
  add constraint GEC_LOCATE_PREBORROW_ARCHV_FK2 foreign key (IM_USER_ID)
  references GEC_USER (USER_ID);
alter table GEC_LOCATE_PREBORROW_ARCHIVE
  add constraint GEC_LOCATE_PREBORROW_ARCHV_FK4 foreign key (STRATEGY_ID)
  references GEC_STRATEGY (STRATEGY_ID);
alter table GEC_LOCATE_PREBORROW_ARCHIVE
  add constraint GEC_LOCATE_PREBORROW_ARCHV_FK5 foreign key (REQUEST_ID)
  references GEC_REQUEST (REQUEST_ID);

--The following 4 index is to improve the performance of loading Trader daily activities and loading IM Locate security
--create index GEC_LOCATE_PREBORROW_ARCHV_IDX on GEC_LOCATE_PREBORROW_ARCHIVE (TRUNC(CREATED_AT),TRADE_DATE) TABLESPACE GEC;
create index GEC_LOCATE_PREBORROW_ARCH_IDX1 on GEC_LOCATE_PREBORROW_ARCHIVE (BUSINESS_DATE) TABLESPACE GEC;

--Improve the performance of loading daily activities by file name(request_id/file_id inside)
create index GEC_LOCATE_PREBORROW_ARCH_IDX4 on GEC_LOCATE_PREBORROW_ARCHIVE (REQUEST_ID) TABLESPACE GEC;
