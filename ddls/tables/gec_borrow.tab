create table GEC_BORROW
(
  BORROW_ID              NUMBER(38) not null,
  BORROW_ORDER_ID        NUMBER(38),
  ASSET_ID               NUMBER(38) not null,
  BROKER_CD              VARCHAR2(6),
  TRADE_DATE             NUMBER(8),
  SETTLE_DATE            NUMBER(8),
  COLLATERAL_TYPE        VARCHAR2(4),
  COLLATERAL_CURRENCY_CD VARCHAR2(3),
  COLLATERAL_LEVEL       NUMBER(9,6),
  BORROW_QTY             NUMBER(38),
  RATE                   NUMBER(14,6),
  PRICE                  NUMBER(28,6),
  AMOUNT                 NUMBER(28,6),
  POSITION_FLAG          VARCHAR2(2),
  COMMENT_TXT            VARCHAR2(4000),
  G1_EXTRACTED_AT        DATE,
  NO_DEMAND_FLAG         VARCHAR2(1) default 'N' not null,
  LOAN_NO                VARCHAR2(6),
  LINK_REFERENCE         VARCHAR2(8),
  TYPE                   VARCHAR2(10),
  INTERVENTION_REASON    VARCHAR2(20),
  STATUS                 VARCHAR2(1) not null,
  PREPAY_DATE	         NUMBER(8),
  PREPAY_RATE	         NUMBER(14,6), 
  RECLAIM_RATE	         NUMBER(9,8),
  OVERSEAS_TAX_PERCENTAGE	NUMBER(9,8),
  DOMESTIC_TAX_PERCENTAGE	NUMBER(9,8),
  MINIMUM_FEE	         NUMBER(14,2),
  MINIMUM_FEE_CD         VARCHAR2(3),
  BOOK_G1_BORROW_FLAG	 VARCHAR2(1) not null,
  EQUILEND_MESSAGE_ID    NUMBER(38),
  CONTINGENTY_INTERVENTION_FLAG   VARCHAR2(1) default 'N',
  CREATED_AT             DATE default sysdate,
  CREATED_BY             VARCHAR2(64),
  UPDATED_AT             DATE default sysdate,
  UPDATED_BY             VARCHAR2(64),
  TERM_DATE              NUMBER(8),
  TERM_TYPE              VARCHAR2(1),--F-ixed/I-nactive
  EXPECTED_RETURN_DATE	 NUMBER(8),
  CROSS_TRADE_FLAG		 VARCHAR2(1) default 'N',
  LAST_UPDATED_AT        DATE,
  LAST_UPDATED_BY        VARCHAR2(64)
)tablespace GEC;

comment on table GEC_BORROW
  is 'This table is used to GEC borrows. NSB and Equilend borrows will be send to G1 for booking, while for SB borrows, the G1 booked borrow is in another table: GEC_G1_SB_BORROW.';
comment on column GEC_BORROW.BORROW_ID
  is 'sequence id';
comment on column GEC_BORROW.BORROW_ORDER_ID
  is 'It should be null for manual borrow, compared with importing borrow response file.';
comment on column GEC_BORROW.BROKER_CD
  is 'Refer to GEC_BROKER.BROKER_CD';
comment on column GEC_BORROW.POSITION_FLAG
  is 'GC/SP';
comment on column GEC_BORROW.G1_EXTRACTED_AT
  is 'The datetime that the borrow is exported to G1 for booking.';
comment on column GEC_BORROW.NO_DEMAND_FLAG
  is 'Values: Y-es, N-o. Y-es means this is a no-demand borrow';
comment on column GEC_BORROW.TYPE
  is 'Values: AUTO, MANUAL';
comment on column GEC_BORROW.INTERVENTION_REASON
  is 'Values: SP, OVERBORROW, NOAUTOBOOKING, NOLOCATEFEE, 0189LNRNINVALID, 0189LNINVALID, NOPREPAYRATE, PSHARE.';
comment on column GEC_BORROW.LOAN_NO
  is 'DML Loan Number from TAD response file';
comment on column GEC_BORROW.BROKER_CD
  is 'BROKER_CD is set to nullable because some legacy short/cover may have blank broker code.';
comment on column GEC_BORROW.PREPAY_DATE
  is 'If the borrow is NON-US, this filed value is needed. It is calculated using settlement date minus trade country"s pre day value or is enterd by trader.';
comment on column GEC_BORROW.PREPAY_RATE
  is 'If the borrow is NON-US,this filed value is needed. It comes from borrow file or UI enterd by trader.';
comment on column GEC_BORROW.RECLAIM_RATE
  is 'If the borrow is NON-US,this filed value is needed. It comes from borrow file or UI enterd by trader.';
comment on column GEC_BORROW.OVERSEAS_TAX_PERCENTAGE
  is 'It comes from UI enterd by trader for Non-US borrow.'; 
comment on column GEC_BORROW.DOMESTIC_TAX_PERCENTAGE
  is 'It comes from UI enterd by trader for Non-US borrow.';
comment on column GEC_BORROW.MINIMUM_FEE
  is 'It comes from borrow file for Non-US borrow.';
comment on column GEC_BORROW.BOOK_G1_BORROW_FLAG
  is 'It comes from GEC_BROKER.BOOK_G1_BORROW_FLAG. It is the value of GEC_BROKER.BOOK_G1_BORROW_FLAG at the time of borrow is imported or entered.';
comment on column GEC_BORROW.CONTINGENTY_INTERVENTION_FLAG
  is 'for the maunual intervetion in contingency mode.';
comment on column GEC_BORROW.CROSS_TRADE_FLAG
  is 'Values: Y, N. A flag to mark the borrow is cross borrow or not.';  
          
ALTER TABLE GEC_BORROW
  ADD CONSTRAINT GEC_BORROW_PK PRIMARY KEY (BORROW_ID)  USING INDEX TABLESPACE  GEC;

alter table GEC_BORROW
  add constraint GEC_BORROW_FK1 foreign key (BORROW_ORDER_ID)
  references GEC_BORROW_ORDER (BORROW_ORDER_ID);    

alter table GEC_BORROW
  add constraint GEC_BORROW_FK2 foreign key (ASSET_ID)
  references GEC_ASSET (ASSET_ID); 
alter table GEC_BORROW
  add constraint GEC_BORROW_FK3 foreign key (EQUILEND_MESSAGE_ID)
  references GEC_EQUILEND_MESSAGE (EQUILEND_MESSAGE_ID);    

